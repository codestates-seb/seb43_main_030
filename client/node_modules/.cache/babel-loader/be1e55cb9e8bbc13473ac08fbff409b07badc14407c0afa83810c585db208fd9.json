{"ast":null,"code":"import{useNavigate}from'react-router-dom';import{PulseLoader}from'react-spinners';import{useDispatch,useSelector}from'react-redux';import axios from'axios';import Swal from'sweetalert2';import{setAuth,// setCurUser,\nsetUser,setCurProfile,setActiveIndex}from'../actions/areaFilterActions';import{jsx as _jsx}from\"react/jsx-runtime\";function OauthLogin(){var navi=useNavigate();var dispatch=useDispatch();var url=new URL(window.location.href);var authorization=url.searchParams.get('Authorization');var refresh=url.searchParams.get('Refresh');var getUsers=function getUsers(){if(localStorage.getItem('token')){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/profile\"),{headers:{Authorization:localStorage.getItem('token')}}).then(function(res){dispatch(setUser(res.data));dispatch(setCurProfile(res.data[0]));axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/profile/currentProfile\"),{headers:{Authorization:localStorage.getItem('token')}}).then(function(res){dispatch(setCurProfile(res.data.data));dispatch(setActiveIndex(res.data.data.profileId));navi('/');});}).catch(function(err){console.log(err);});}};if(authorization){dispatch(setAuth(true));localStorage.setItem('token',authorization);localStorage.setItem('tokenRefresh',refresh);getUsers();}else if(!authorization){navi('/login');Swal.fire({icon:'error',text:'로그인에 실패했습니다.',confirmButtonColor:'#FFD337'});}return/*#__PURE__*/_jsx(\"div\",{className:\"flex-center h-[50vh] w-[100%]\",children:/*#__PURE__*/_jsx(PulseLoader,{color:\"#FFD337\"})});}export default OauthLogin;","map":{"version":3,"names":["useNavigate","PulseLoader","useDispatch","useSelector","axios","Swal","setAuth","setUser","setCurProfile","setActiveIndex","jsx","_jsx","OauthLogin","navi","dispatch","url","URL","window","location","href","authorization","searchParams","get","refresh","getUsers","localStorage","getItem","concat","process","env","REACT_APP_API_URL","headers","Authorization","then","res","data","profileId","catch","err","console","log","setItem","fire","icon","text","confirmButtonColor","className","children","color"],"sources":["/Users/jieun/Desktop/main-project/idle/src/pages/OauthLogin.jsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\nimport { PulseLoader } from 'react-spinners';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport {\n  setAuth,\n  // setCurUser,\n  setUser,\n  setCurProfile,\n  setActiveIndex,\n} from '../actions/areaFilterActions';\n\nfunction OauthLogin() {\n  const navi = useNavigate();\n  const dispatch = useDispatch();\n\n  const url = new URL(window.location.href);\n  const authorization = url.searchParams.get('Authorization');\n  const refresh = url.searchParams.get('Refresh');\n\n  const getUsers = () => {\n    if (localStorage.getItem('token')) {\n      axios\n        .get(`${process.env.REACT_APP_API_URL}/api/users/profile`, {\n          headers: {\n            Authorization: localStorage.getItem('token'),\n          },\n        })\n        .then(res => {\n          dispatch(setUser(res.data));\n          dispatch(setCurProfile(res.data[0]));\n          axios\n            .get(\n              `${process.env.REACT_APP_API_URL}/api/users/profile/currentProfile`,\n              {\n                headers: {\n                  Authorization: localStorage.getItem('token'),\n                },\n              },\n            )\n            .then(res => {\n              dispatch(setCurProfile(res.data.data));\n              dispatch(setActiveIndex(res.data.data.profileId));\n              navi('/');\n            });\n        })\n        .catch(err => {\n          console.log(err);\n        });\n    }\n  };\n\n  if (authorization) {\n    dispatch(setAuth(true));\n    localStorage.setItem('token', authorization);\n    localStorage.setItem('tokenRefresh', refresh);\n    getUsers();\n  } else if (!authorization) {\n    navi('/login');\n\n    Swal.fire({\n      icon: 'error',\n      text: '로그인에 실패했습니다.',\n      confirmButtonColor: '#FFD337',\n    });\n  }\n\n  return (\n    <div className=\"flex-center h-[50vh] w-[100%]\">\n      <PulseLoader color=\"#FFD337\" />\n    </div>\n  );\n}\n\nexport default OauthLogin;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}