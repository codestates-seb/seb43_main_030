{"ast":null,"code":"var _jsxFileName = \"/Users/jieun/Desktop/main-project/idle/src/pages/OauthLogin.jsx\",\n  _s = $RefreshSig$();\nimport { useNavigate } from 'react-router-dom';\nimport { PulseLoader } from 'react-spinners';\nimport { useDispatch, useSelector } from 'react-redux';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport { setAuth,\n// setCurUser,\nsetUser, setCurProfile, setActiveIndex } from '../actions/areaFilterActions';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction OauthLogin() {\n  _s();\n  const navi = useNavigate();\n  const dispatch = useDispatch();\n  const user = useSelector(state => state.user);\n  const curProfile = useSelector(state => state.curProfile);\n  const activeIndex = useSelector(state => state.activeIndex);\n  const url = new URL(window.location.href);\n  const authorization = url.searchParams.get('Authorization');\n  const refresh = url.searchParams.get('Refresh');\n  const getUsers = () => {\n    if (localStorage.getItem('token')) {\n      axios.get(`${process.env.REACT_APP_API_URL}/api/users/profile`, {\n        headers: {\n          Authorization: localStorage.getItem('token')\n        }\n      }).then(res => {\n        console.log('user:', res);\n        dispatch(setUser(res.data));\n        dispatch(setCurProfile(res.data[0]));\n        // dispatch(setActiveIndex(res.data[0].profileId));\n        // navi('/');\n        axios.get(`${process.env.REACT_APP_API_URL}/api/users/profile/currentProfile`, {\n          headers: {\n            Authorization: localStorage.getItem('token')\n          }\n        }).then(res => {\n          console.log('curprofile:', res);\n          dispatch(setCurProfile(res.data.data));\n          dispatch(setActiveIndex(res.data.data.profileId));\n          navi('/');\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  };\n\n  // 만약 authorization 이 있는데, role 이 게스트야\n  // 그러면 이메일이랑, 롤 선택하는로 가 => patch 로 보내려면 token을 같이 보내야된다며,,\n\n  if (authorization) {\n    dispatch(setAuth(true));\n    localStorage.setItem('token', authorization);\n    localStorage.setItem('tokenRefresh', refresh);\n    getUsers();\n    // if 만약 role 이 guest면 모달이던 그걸 띄워 그래서 아이디랑 이걸 입력하게 하는거야\n    // 근데 role이 guest가 아니면 걍 메인으로 가\n  } else if (!authorization) {\n    // Swal.fire({\n    //   icon: 'error',\n    //   text: '로그인에 실패했습니다.',\n    //   confirmButtonColor: '#FFD337',\n    // });\n    // alert('로그인에 실패했습니다.');\n    navi('/login');\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex-center h-[50vh] w-[100%]\",\n    children: /*#__PURE__*/_jsxDEV(PulseLoader, {\n      color: \"#FFD337\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n}\n_s(OauthLogin, \"qJNET0JAmyeww6XavOYoaAftouM=\", false, function () {\n  return [useNavigate, useDispatch, useSelector, useSelector, useSelector];\n});\n_c = OauthLogin;\nexport default OauthLogin;\nvar _c;\n$RefreshReg$(_c, \"OauthLogin\");","map":{"version":3,"names":["useNavigate","PulseLoader","useDispatch","useSelector","axios","Swal","setAuth","setUser","setCurProfile","setActiveIndex","jsxDEV","_jsxDEV","OauthLogin","_s","navi","dispatch","user","state","curProfile","activeIndex","url","URL","window","location","href","authorization","searchParams","get","refresh","getUsers","localStorage","getItem","process","env","REACT_APP_API_URL","headers","Authorization","then","res","console","log","data","profileId","catch","err","setItem","className","children","color","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/jieun/Desktop/main-project/idle/src/pages/OauthLogin.jsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\nimport { PulseLoader } from 'react-spinners';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport {\n  setAuth,\n  // setCurUser,\n  setUser,\n  setCurProfile,\n  setActiveIndex,\n} from '../actions/areaFilterActions';\n\nfunction OauthLogin() {\n  const navi = useNavigate();\n  const dispatch = useDispatch();\n\n  const user = useSelector(state => state.user);\n  const curProfile = useSelector(state => state.curProfile);\n  const activeIndex = useSelector(state => state.activeIndex);\n\n  const url = new URL(window.location.href);\n  const authorization = url.searchParams.get('Authorization');\n  const refresh = url.searchParams.get('Refresh');\n\n  const getUsers = () => {\n    if (localStorage.getItem('token')) {\n      axios\n        .get(`${process.env.REACT_APP_API_URL}/api/users/profile`, {\n          headers: {\n            Authorization: localStorage.getItem('token'),\n          },\n        })\n        .then(res => {\n          console.log('user:', res);\n          dispatch(setUser(res.data));\n          dispatch(setCurProfile(res.data[0]));\n          // dispatch(setActiveIndex(res.data[0].profileId));\n          // navi('/');\n          axios\n            .get(\n              `${process.env.REACT_APP_API_URL}/api/users/profile/currentProfile`,\n              {\n                headers: {\n                  Authorization: localStorage.getItem('token'),\n                },\n              },\n            )\n            .then(res => {\n              console.log('curprofile:', res);\n              dispatch(setCurProfile(res.data.data));\n              dispatch(setActiveIndex(res.data.data.profileId));\n              navi('/');\n            });\n        })\n        .catch(err => {\n          console.log(err);\n        });\n    }\n  };\n\n  // 만약 authorization 이 있는데, role 이 게스트야\n  // 그러면 이메일이랑, 롤 선택하는로 가 => patch 로 보내려면 token을 같이 보내야된다며,,\n\n  if (authorization) {\n    dispatch(setAuth(true));\n    localStorage.setItem('token', authorization);\n    localStorage.setItem('tokenRefresh', refresh);\n    getUsers();\n    // if 만약 role 이 guest면 모달이던 그걸 띄워 그래서 아이디랑 이걸 입력하게 하는거야\n    // 근데 role이 guest가 아니면 걍 메인으로 가\n  } else if (!authorization) {\n    // Swal.fire({\n    //   icon: 'error',\n    //   text: '로그인에 실패했습니다.',\n    //   confirmButtonColor: '#FFD337',\n    // });\n    // alert('로그인에 실패했습니다.');\n    navi('/login');\n  }\n\n  return (\n    <div className=\"flex-center h-[50vh] w-[100%]\">\n      <PulseLoader color=\"#FFD337\" />\n    </div>\n  );\n}\n\nexport default OauthLogin;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}