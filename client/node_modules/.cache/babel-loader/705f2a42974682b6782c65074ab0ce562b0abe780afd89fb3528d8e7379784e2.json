{"ast":null,"code":"import{useNavigate}from'react-router-dom';import{PulseLoader}from'react-spinners';import{useDispatch,useSelector}from'react-redux';import axios from'axios';import{setAuth,setCurUser,setUser,setCurProfile}from'../actions/areaFilterActions';import{jsx as _jsx}from\"react/jsx-runtime\";function OauthLogin(){var navi=useNavigate();var dispatch=useDispatch();var url=new URL(window.location.href);var authorization=url.searchParams.get('Authorization');var refresh=url.searchParams.get('Refresh');var getUsers=function getUsers(){if(localStorage.getItem('token')){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/users/profile\"),{headers:{Authorization:localStorage.getItem('token')}}).then(function(res){dispatch(setUser(res.data));dispatch(setCurUser(res.data[0]));dispatch(setCurProfile(res.data[0]));navi('/');}).catch(function(err){console.log(err);});}};// 만약 authorization 이 있는데, role 이 게스트야\n// 그러면 이메일이랑, 롤 선택하는로 가 => patch 로 보내려면 token을 같이 보내야된다며,,\nif(authorization){dispatch(setAuth(true));localStorage.setItem('token',authorization);localStorage.setItem('tokenRefresh',refresh);getUsers();// if 만약 role 이 guest면 모달이던 그걸 띄워 그래서 아이디랑 이걸 입력하게 하는거야\n// 근데 role이 guest가 아니면 걍 메인으로 가\n}else{alert('로그인에 실패했습니다.');navi('/login');}return/*#__PURE__*/_jsx(\"div\",{className:\"flex-center h-[50vh] w-[100%]\",children:/*#__PURE__*/_jsx(PulseLoader,{color:\"#FFD337\"})});}export default OauthLogin;","map":{"version":3,"names":["useNavigate","PulseLoader","useDispatch","useSelector","axios","setAuth","setCurUser","setUser","setCurProfile","jsx","_jsx","OauthLogin","navi","dispatch","url","URL","window","location","href","authorization","searchParams","get","refresh","getUsers","localStorage","getItem","concat","process","env","REACT_APP_API_URL","headers","Authorization","then","res","data","catch","err","console","log","setItem","alert","className","children","color"],"sources":["/Users/jieun/Desktop/main-project/idle/src/pages/OauthLogin.jsx"],"sourcesContent":["import { useNavigate } from 'react-router-dom';\nimport { PulseLoader } from 'react-spinners';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport axios from 'axios';\nimport {\n  setAuth,\n  setCurUser,\n  setUser,\n  setCurProfile,\n} from '../actions/areaFilterActions';\n\nfunction OauthLogin() {\n  const navi = useNavigate();\n  const dispatch = useDispatch();\n\n  const url = new URL(window.location.href);\n  const authorization = url.searchParams.get('Authorization');\n  const refresh = url.searchParams.get('Refresh');\n\n  const getUsers = () => {\n    if (localStorage.getItem('token')) {\n      axios\n        .get(`${process.env.REACT_APP_API_URL}/users/profile`, {\n          headers: {\n            Authorization: localStorage.getItem('token'),\n          },\n        })\n        .then(res => {\n          dispatch(setUser(res.data));\n          dispatch(setCurUser(res.data[0]));\n          dispatch(setCurProfile(res.data[0]));\n          navi('/');\n        })\n        .catch(err => {\n          console.log(err);\n        });\n    }\n  };\n\n  // 만약 authorization 이 있는데, role 이 게스트야\n  // 그러면 이메일이랑, 롤 선택하는로 가 => patch 로 보내려면 token을 같이 보내야된다며,,\n\n  if (authorization) {\n    dispatch(setAuth(true));\n    localStorage.setItem('token', authorization);\n    localStorage.setItem('tokenRefresh', refresh);\n    getUsers();\n    // if 만약 role 이 guest면 모달이던 그걸 띄워 그래서 아이디랑 이걸 입력하게 하는거야\n    // 근데 role이 guest가 아니면 걍 메인으로 가\n  } else {\n    alert('로그인에 실패했습니다.');\n    navi('/login');\n  }\n\n  return (\n    <div className=\"flex-center h-[50vh] w-[100%]\">\n      <PulseLoader color=\"#FFD337\" />\n    </div>\n  );\n}\n\nexport default OauthLogin;\n"],"mappings":"AAAA,OAASA,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,WAAW,KAAQ,gBAAgB,CAC5C,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CAEtD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OACEC,OAAO,CACPC,UAAU,CACVC,OAAO,CACPC,aAAa,KACR,8BAA8B,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAEtC,QAAS,CAAAC,UAAUA,CAAA,CAAG,CACpB,GAAM,CAAAC,IAAI,CAAGZ,WAAW,CAAC,CAAC,CAC1B,GAAM,CAAAa,QAAQ,CAAGX,WAAW,CAAC,CAAC,CAE9B,GAAM,CAAAY,GAAG,CAAG,GAAI,CAAAC,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC,CACzC,GAAM,CAAAC,aAAa,CAAGL,GAAG,CAACM,YAAY,CAACC,GAAG,CAAC,eAAe,CAAC,CAC3D,GAAM,CAAAC,OAAO,CAAGR,GAAG,CAACM,YAAY,CAACC,GAAG,CAAC,SAAS,CAAC,CAE/C,GAAM,CAAAE,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAA,CAAS,CACrB,GAAIC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAAE,CACjCrB,KAAK,CACFiB,GAAG,IAAAK,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,iBAAiB,mBAAkB,CACrDC,OAAO,CAAE,CACPC,aAAa,CAAEP,YAAY,CAACC,OAAO,CAAC,OAAO,CAC7C,CACF,CAAC,CAAC,CACDO,IAAI,CAAC,SAAAC,GAAG,CAAI,CACXpB,QAAQ,CAACN,OAAO,CAAC0B,GAAG,CAACC,IAAI,CAAC,CAAC,CAC3BrB,QAAQ,CAACP,UAAU,CAAC2B,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CACjCrB,QAAQ,CAACL,aAAa,CAACyB,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CACpCtB,IAAI,CAAC,GAAG,CAAC,CACX,CAAC,CAAC,CACDuB,KAAK,CAAC,SAAAC,GAAG,CAAI,CACZC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAClB,CAAC,CAAC,CACN,CACF,CAAC,CAED;AACA;AAEA,GAAIjB,aAAa,CAAE,CACjBN,QAAQ,CAACR,OAAO,CAAC,IAAI,CAAC,CAAC,CACvBmB,YAAY,CAACe,OAAO,CAAC,OAAO,CAAEpB,aAAa,CAAC,CAC5CK,YAAY,CAACe,OAAO,CAAC,cAAc,CAAEjB,OAAO,CAAC,CAC7CC,QAAQ,CAAC,CAAC,CACV;AACA;AACF,CAAC,IAAM,CACLiB,KAAK,CAAC,cAAc,CAAC,CACrB5B,IAAI,CAAC,QAAQ,CAAC,CAChB,CAEA,mBACEF,IAAA,QAAK+B,SAAS,CAAC,+BAA+B,CAAAC,QAAA,cAC5ChC,IAAA,CAACT,WAAW,EAAC0C,KAAK,CAAC,SAAS,CAAE,CAAC,CAC5B,CAAC,CAEV,CAEA,cAAe,CAAAhC,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}