{"ast":null,"code":"import _objectSpread from\"/Users/jieun/Desktop/main-project/idle/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/jieun/Desktop/main-project/idle/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from'axios';import{useMediaQuery}from'react-responsive';import{useCallback,useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import Button from'../components/Button/Button';import Input from'../components/Input/Input';import RadioGroup from'../components/Radio/RadioGroup';import Radio from'../components/Radio/Radio';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function OauthRole(){var navi=useNavigate();var isMobile=useMediaQuery({query:'(max-width: 767px)'});var _useState=useState({email:'',checkTeacher:''}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),officials=_useState4[0],setOfficials=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),emailErr=_useState6[0],setEmailErr=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isEmail=_useState8[0],setIsEmail=_useState8[1];var handleOfficialsClick=function handleOfficialsClick(value){return function(){setOfficials(value);};};var url=new URL(window.location.href);var authorization=url.searchParams.get('Authorization');var userEmail=url.searchParams.get('email');var onCheckEmail=useCallback(function(e){var valiEmail=/([\\w-.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([\\w-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$/;var CurrentEmail=e.target.value;setUser(_objectSpread(_objectSpread({},user),{},{email:CurrentEmail}));if(user.email.length===0){setEmailErr('이메일을 입력해주세요.');setIsEmail(false);}else if(!valiEmail.test(CurrentEmail)){setEmailErr('이메일 형식이 올바르지 않습니다.');setIsEmail(false);}else{setEmailErr('');setIsEmail(true);}},[user]);var onRoleChange=function onRoleChange(e){e.preventDefault();onCheckEmail(e);if(isEmail){setEmailErr('');axios.patch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/oauthInit\"),{email:user.email,checkOfficials:officials},{headers:{Authorization:authorization}}).then(function(res){navi('/login');console.log(res);setIsEmail(false);}).catch(function(err){console.log(err);if(err.response&&err.response.status===500){setEmailErr('이미 가입되어 있는 이메일입니다.');}});}if(userEmail){axios.patch(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/oauthInit\"),{checkOfficials:officials},{headers:{Authorization:authorization}}).then(function(res){navi('/login');console.log(res);setIsEmail(false);}).catch(function(err){console.log(err);if(err.response&&err.response.status===500){setEmailErr('이미 가입되어 있는 이메일입니다.');}});}};var oauthrole=function oauthrole(){return/*#__PURE__*/_jsxs(\"form\",{className:\"px-8\",onSubmit:onRoleChange,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-24 flex flex-col\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"mb-8 text-left text-14 text-black-350\",children:\"\\uC0DD\\uC131 \\uACC4\\uC815 \\uC120\\uD0DD\"}),/*#__PURE__*/_jsxs(RadioGroup,{children:[/*#__PURE__*/_jsx(Radio,{id:\"1\",name:\"contact\",value:\"user\",onClick:handleOfficialsClick(false),defaultChecked:true,children:\"\\uACAC\\uC8FC\\uB2D8\"}),/*#__PURE__*/_jsx(Radio,{id:\"2\",name:\"contact\",value:\"owner\",onClick:handleOfficialsClick(true),children:\"\\uC720\\uCE58\\uC6D0 \\uAD00\\uACC4\\uC790\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-24\",children:!userEmail?/*#__PURE__*/_jsx(Input,{labelText:\"\\uC774\\uBA54\\uC77C\",type:\"email\",placeholder:\"\\uC774\\uBA54\\uC77C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",onChange:onCheckEmail,isError:emailErr}):/*#__PURE__*/_jsx(Input,{labelText:\"\\uC774\\uBA54\\uC77C\",type:\"email\",placeholder:\"\\uC774\\uBA54\\uC77C \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",value:userEmail,disabled:userEmail})}),/*#__PURE__*/_jsx(Button,{className:\"color-yellow btn-size-l w-full\"// disabled={!(isEmail && isPwd && isConfirmPwd && isConfirmEmail)}\n,onClick:onRoleChange,children:\"\\uACC4\\uC815 \\uC815\\uBCF4 \\uC800\\uC7A5\\uD558\\uAE30\"})]});};return/*#__PURE__*/_jsx(\"div\",{className:\"flex-center onlyMobile:login-m-align h-screen bg-black-025 onlyMobile:bg-white\",children:/*#__PURE__*/_jsx(\"div\",{className:\"mt-80 onlyMobile:w-full onlyMobile:px-24\",children:!isMobile?/*#__PURE__*/_jsx(\"div\",{className:\"login-card\",children:oauthrole()}):/*#__PURE__*/_jsx(\"div\",{children:oauthrole()})})});}export default OauthRole;","map":{"version":3,"names":["axios","useMediaQuery","useCallback","useState","useEffect","Link","useNavigate","Button","Input","RadioGroup","Radio","jsx","_jsx","jsxs","_jsxs","OauthRole","navi","isMobile","query","_useState","email","checkTeacher","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","officials","setOfficials","_useState5","_useState6","emailErr","setEmailErr","_useState7","_useState8","isEmail","setIsEmail","handleOfficialsClick","value","url","URL","window","location","href","authorization","searchParams","get","userEmail","onCheckEmail","e","valiEmail","CurrentEmail","target","_objectSpread","length","test","onRoleChange","preventDefault","patch","concat","process","env","REACT_APP_API_URL","checkOfficials","headers","Authorization","then","res","console","log","catch","err","response","status","oauthrole","className","onSubmit","children","id","name","onClick","defaultChecked","labelText","type","placeholder","onChange","isError","disabled"],"sources":["/Users/jieun/Desktop/main-project/idle/src/pages/OauthRole.jsx"],"sourcesContent":["import axios from 'axios';\nimport { useMediaQuery } from 'react-responsive';\nimport { useCallback, useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport Button from '../components/Button/Button';\nimport Input from '../components/Input/Input';\nimport RadioGroup from '../components/Radio/RadioGroup';\nimport Radio from '../components/Radio/Radio';\n\nfunction OauthRole() {\n  const navi = useNavigate();\n  const isMobile = useMediaQuery({ query: '(max-width: 767px)' });\n\n  const [user, setUser] = useState({\n    email: '',\n    checkTeacher: '',\n  });\n\n  const [officials, setOfficials] = useState(false);\n\n  const [emailErr, setEmailErr] = useState('');\n  const [isEmail, setIsEmail] = useState(false);\n\n  const handleOfficialsClick = value => () => {\n    setOfficials(value);\n  };\n\n  const url = new URL(window.location.href);\n  const authorization = url.searchParams.get('Authorization');\n  const userEmail = url.searchParams.get('email');\n\n  const onCheckEmail = useCallback(\n    e => {\n      const valiEmail =\n        /([\\w-.]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([\\w-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$/;\n      const CurrentEmail = e.target.value;\n      setUser({ ...user, email: CurrentEmail });\n\n      if (user.email.length === 0) {\n        setEmailErr('이메일을 입력해주세요.');\n        setIsEmail(false);\n      } else if (!valiEmail.test(CurrentEmail)) {\n        setEmailErr('이메일 형식이 올바르지 않습니다.');\n        setIsEmail(false);\n      } else {\n        setEmailErr('');\n        setIsEmail(true);\n      }\n    },\n    [user],\n  );\n\n  const onRoleChange = e => {\n    e.preventDefault();\n    onCheckEmail(e);\n\n    if (isEmail) {\n      setEmailErr('');\n\n      axios\n        .patch(\n          `${process.env.REACT_APP_API_URL}/api/users/oauthInit`,\n          {\n            email: user.email,\n            checkOfficials: officials,\n          },\n          {\n            headers: {\n              Authorization: authorization,\n            },\n          },\n        )\n        .then(res => {\n          navi('/login');\n          console.log(res);\n          setIsEmail(false);\n        })\n        .catch(err => {\n          console.log(err);\n          if (err.response && err.response.status === 500) {\n            setEmailErr('이미 가입되어 있는 이메일입니다.');\n          }\n        });\n    }\n\n    if (userEmail) {\n      axios\n        .patch(\n          `${process.env.REACT_APP_API_URL}/api/users/oauthInit`,\n          {\n            checkOfficials: officials,\n          },\n          {\n            headers: {\n              Authorization: authorization,\n            },\n          },\n        )\n        .then(res => {\n          navi('/login');\n          console.log(res);\n          setIsEmail(false);\n        })\n        .catch(err => {\n          console.log(err);\n          if (err.response && err.response.status === 500) {\n            setEmailErr('이미 가입되어 있는 이메일입니다.');\n          }\n        });\n    }\n  };\n\n  const oauthrole = () => {\n    return (\n      <form className=\"px-8\" onSubmit={onRoleChange}>\n        <div className=\"mb-24 flex flex-col\">\n          <p className=\"mb-8 text-left text-14 text-black-350\">\n            생성 계정 선택\n          </p>\n          <RadioGroup>\n            <Radio\n              id=\"1\"\n              name=\"contact\"\n              value=\"user\"\n              onClick={handleOfficialsClick(false)}\n              defaultChecked\n            >\n              견주님\n            </Radio>\n            <Radio\n              id=\"2\"\n              name=\"contact\"\n              value=\"owner\"\n              onClick={handleOfficialsClick(true)}\n            >\n              유치원 관계자\n            </Radio>\n          </RadioGroup>\n        </div>\n        <div className=\"mb-24\">\n          {!userEmail ? (\n            <Input\n              labelText=\"이메일\"\n              type=\"email\"\n              placeholder=\"이메일 입력해주세요.\"\n              onChange={onCheckEmail}\n              isError={emailErr}\n            />\n          ) : (\n            <Input\n              labelText=\"이메일\"\n              type=\"email\"\n              placeholder=\"이메일 입력해주세요.\"\n              value={userEmail}\n              disabled={userEmail}\n            />\n          )}\n        </div>\n        <Button\n          className=\"color-yellow btn-size-l w-full\"\n          // disabled={!(isEmail && isPwd && isConfirmPwd && isConfirmEmail)}\n          onClick={onRoleChange}\n        >\n          계정 정보 저장하기\n        </Button>\n      </form>\n    );\n  };\n\n  return (\n    <div className=\"flex-center onlyMobile:login-m-align h-screen bg-black-025 onlyMobile:bg-white\">\n      <div className=\"mt-80 onlyMobile:w-full onlyMobile:px-24\">\n        {!isMobile ? (\n          <div className=\"login-card\">{oauthrole()}</div>\n        ) : (\n          <div>{oauthrole()}</div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default OauthRole;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}