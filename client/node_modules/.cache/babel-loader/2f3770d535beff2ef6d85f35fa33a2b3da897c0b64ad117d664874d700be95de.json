{"ast":null,"code":"import{useState,useEffect}from'react';import axios from'axios';import Swal from'sweetalert2';import{Link}from'react-router-dom';import{useSelector,useDispatch}from'react-redux';import{setCurProfile,setAuth,setActiveIndex,setUser}from'../actions/areaFilterActions';import Profile from'../images/profile.png';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function DropDownMenu(_ref){var setDropDown=_ref.setDropDown;var dispatch=useDispatch();var user=useSelector(function(state){return state.user;});var curProfile=useSelector(function(state){return state.curProfile;});var activeIndex=useSelector(function(state){return state.activeIndex;});useEffect(function(){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/profile\"),{headers:{Authorization:localStorage.getItem('token')}}).then(function(res){dispatch(setUser(res.data));});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);var handleLogout=function handleLogout(){dispatch(setAuth(false));localStorage.removeItem('token');dispatch(setUser([]));dispatch(setCurProfile({}));dispatch(setActiveIndex(''));};function clickedProfile(profileId){axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/profile/\").concat(profileId),{},{headers:{Authorization:localStorage.getItem('token')}}).then(function(){axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/users/profile/currentProfile\"),{headers:{Authorization:localStorage.getItem('token')}}).then(function(res){dispatch(setCurProfile(res.data.data));setDropDown(false);dispatch(setActiveIndex(res.data.data.profileId));}).catch(function(err){});}).catch(function(err){if(err.response&&err.response.status===401){Swal.fire({icon:'error',text:'토큰이 만료되었습니다. 재로그인 해주세요❗️',confirmButtonColor:'#FFD337'});dispatch(setAuth(false));localStorage.removeItem('token');}});}// function profileActive(e) {\n//   const classList = e.target.className.split(' ');\n//   const indexClass = classList.find(className =>\n//     className.startsWith('profile'),\n//   );\n//   if (indexClass) {\n//     const index = parseInt(indexClass.slice(-1), 10);\n//     dispatch(setActiveIndex(index));\n//   }\n// }\nvar RenderProfile=function RenderProfile(){return user.map(function(profile){var activeClass=profile.profileId===activeIndex?'font-bold':'';return/*#__PURE__*/_jsx(\"li\",{className:\"profile flex items-center justify-start\".concat(profile.profileId,\" cursor-pointer px-8 py-12 text-14 \").concat(activeClass,\" rounded-lg hover:bg-black-025\"),onClick:function onClick(e){clickedProfile(profile.profileId);},role:\"presentation\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex w-full justify-between\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex\",children:[profile.profileId===activeIndex&&/*#__PURE__*/_jsx(\"div\",{className:\"user-profile mr-10 inline-block h-24 w-24 rounded-md\",children:/*#__PURE__*/_jsx(\"img\",{src:profile.imageUrl||Profile,alt:\"profileimage\"})}),profile.name]})})},profile.profileId);});};return/*#__PURE__*/_jsxs(\"div\",{className:\"absolute left-0 top-[64px] z-10 flex w-226 flex-col items-start justify-center rounded-[10px] bg-white px-12 py-16 shadow-dropDownShadow onlyMobile:w-[100%]\",children:[/*#__PURE__*/_jsxs(\"ul\",{className:\"profile w-202 py-2 text-left onlyMobile:w-[100%]\",children:[/*#__PURE__*/_jsx(\"li\",{className:\"px-8 pb-8 text-12 text-black-350\",children:\"\\uD504\\uB85C\\uD544\"}),/*#__PURE__*/_jsx(RenderProfile,{}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 h-1 border-b\"})]}),/*#__PURE__*/_jsxs(\"ul\",{className:\"w-202 text-left onlyMobile:w-[100%]\",children:[/*#__PURE__*/_jsx(Link,{to:\"/mypage/\".concat(curProfile.profileId),onClick:function onClick(){return setDropDown(false);},children:/*#__PURE__*/_jsx(\"li\",{className:\"flex cursor-pointer items-center justify-start rounded-md px-8 py-12 text-14 hover:bg-black-025\",children:\"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"})}),/*#__PURE__*/_jsx(Link,{to:\"/\",children:/*#__PURE__*/_jsx(\"li\",{role:\"presentation\",className:\"cursor-pointer items-center justify-start rounded-md px-8 py-12 text-14 hover:bg-black-025\",onClick:function onClick(){return handleLogout();},children:\"\\uB85C\\uADF8\\uC544\\uC6C3\"})})]})]});}export default DropDownMenu;","map":{"version":3,"names":["useState","useEffect","axios","Swal","Link","useSelector","useDispatch","setCurProfile","setAuth","setActiveIndex","setUser","Profile","jsx","_jsx","jsxs","_jsxs","DropDownMenu","_ref","setDropDown","dispatch","user","state","curProfile","activeIndex","get","concat","process","env","REACT_APP_API_URL","headers","Authorization","localStorage","getItem","then","res","data","handleLogout","removeItem","clickedProfile","profileId","post","catch","err","response","status","fire","icon","text","confirmButtonColor","RenderProfile","map","profile","activeClass","className","onClick","e","role","children","src","imageUrl","alt","name","to"],"sources":["/Users/jieun/Desktop/main-project/idle/src/components/DropDownMenu.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Swal from 'sweetalert2';\nimport { Link } from 'react-router-dom';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n  setCurProfile,\n  setAuth,\n  setActiveIndex,\n  setUser,\n} from '../actions/areaFilterActions';\nimport Profile from '../images/profile.png';\n\nfunction DropDownMenu({ setDropDown }) {\n  const dispatch = useDispatch();\n\n  const user = useSelector(state => state.user);\n  const curProfile = useSelector(state => state.curProfile);\n  const activeIndex = useSelector(state => state.activeIndex);\n\n  useEffect(() => {\n    axios\n      .get(`${process.env.REACT_APP_API_URL}/api/users/profile`, {\n        headers: {\n          Authorization: localStorage.getItem('token'),\n        },\n      })\n      .then(res => {\n        dispatch(setUser(res.data));\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const handleLogout = () => {\n    dispatch(setAuth(false));\n    localStorage.removeItem('token');\n    dispatch(setUser([]));\n    dispatch(setCurProfile({}));\n    dispatch(setActiveIndex(''));\n  };\n\n  function clickedProfile(profileId) {\n    axios\n      .post(\n        `${process.env.REACT_APP_API_URL}/api/users/profile/${profileId}`,\n        {},\n        {\n          headers: {\n            Authorization: localStorage.getItem('token'),\n          },\n        },\n      )\n      .then(() => {\n        axios\n          .get(\n            `${process.env.REACT_APP_API_URL}/api/users/profile/currentProfile`,\n            {\n              headers: {\n                Authorization: localStorage.getItem('token'),\n              },\n            },\n          )\n          .then(res => {\n            dispatch(setCurProfile(res.data.data));\n            setDropDown(false);\n            dispatch(setActiveIndex(res.data.data.profileId));\n          })\n          .catch(err => {});\n      })\n      .catch(err => {\n        if (err.response && err.response.status === 401) {\n          Swal.fire({\n            icon: 'error',\n            text: '토큰이 만료되었습니다. 재로그인 해주세요❗️',\n            confirmButtonColor: '#FFD337',\n          });\n          dispatch(setAuth(false));\n          localStorage.removeItem('token');\n        }\n      });\n  }\n\n  // function profileActive(e) {\n  //   const classList = e.target.className.split(' ');\n  //   const indexClass = classList.find(className =>\n  //     className.startsWith('profile'),\n  //   );\n  //   if (indexClass) {\n  //     const index = parseInt(indexClass.slice(-1), 10);\n  //     dispatch(setActiveIndex(index));\n  //   }\n  // }\n\n  const RenderProfile = () => {\n    return user.map(profile => {\n      const activeClass = profile.profileId === activeIndex ? 'font-bold' : '';\n\n      return (\n        <li\n          className={`profile flex items-center justify-start${profile.profileId} cursor-pointer px-8 py-12 text-14 ${activeClass} rounded-lg hover:bg-black-025`}\n          onClick={e => {\n            clickedProfile(profile.profileId);\n          }}\n          role=\"presentation\"\n          key={profile.profileId}\n        >\n          <div className=\"flex w-full justify-between\">\n            <div className=\"flex\">\n              {profile.profileId === activeIndex && (\n                <div className=\"user-profile mr-10 inline-block h-24 w-24 rounded-md\">\n                  <img src={profile.imageUrl || Profile} alt=\"profileimage\" />\n                </div>\n              )}\n              {profile.name}\n            </div>\n          </div>\n        </li>\n      );\n    });\n  };\n\n  return (\n    <div className=\"absolute left-0 top-[64px] z-10 flex w-226 flex-col items-start justify-center rounded-[10px] bg-white px-12 py-16 shadow-dropDownShadow onlyMobile:w-[100%]\">\n      <ul className=\"profile w-202 py-2 text-left onlyMobile:w-[100%]\">\n        <li className=\"px-8 pb-8 text-12 text-black-350\">프로필</li>\n        <RenderProfile />\n        <div className=\"mt-2 h-1 border-b\" />\n      </ul>\n      <ul className=\"w-202 text-left onlyMobile:w-[100%]\">\n        <Link\n          to={`/mypage/${curProfile.profileId}`}\n          onClick={() => setDropDown(false)}\n        >\n          <li className=\"flex cursor-pointer items-center justify-start rounded-md px-8 py-12 text-14 hover:bg-black-025\">\n            마이페이지\n          </li>\n        </Link>\n        <Link to=\"/\">\n          <li\n            role=\"presentation\"\n            className=\"cursor-pointer items-center justify-start rounded-md px-8 py-12 text-14 hover:bg-black-025\"\n            onClick={() => handleLogout()}\n          >\n            로그아웃\n          </li>\n        </Link>\n      </ul>\n    </div>\n  );\n}\n\nexport default DropDownMenu;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}